package com.alibaba.nacos.client.config.impl;

import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.nullValue;
import static org.hamcrest.core.Is.is;

import org.junit.jupiter.api.Test;

/**
 * Unit tests for com.alibaba.nacos.client.config.impl.LocalConfigInfoProcessor
 *
 * @author Diffblue Cover
 */

class LocalConfigInfoProcessorTest {

    @Test
    void getFailoverGroupIsBarAndServerNameIsAcmeReturnsNull() {
        assertThat(LocalConfigInfoProcessor.getFailover("Acme", "1234", "bar", "en_GB"), is(nullValue()));
    }

    @Test
    void getSnapshot() {
        assertThat(LocalConfigInfoProcessor.getSnapshot("Acme", "", "en_GB", "en_GB"), is(nullValue()));
        assertThat(LocalConfigInfoProcessor.getSnapshot("Acme", "1234", "bar", "en_GB"), is(nullValue()));
    }

    @Test
    void saveSnapshotConfigIsBar() {
        LocalConfigInfoProcessor.saveSnapshot("Acme", "1234", "en_GB", "en_GB", "bar");
    }

    @Test
    void saveSnapshotDataIdIsEmpty() {
        LocalConfigInfoProcessor.saveSnapshot("Acme", "", "en_GB", "en_GB", "en_GB");
    }

    @Test
    void saveSnapshotGroupIsBar() {
        LocalConfigInfoProcessor.saveSnapshot("Acme", "1234", "bar", "en_GB", "en_GB");
    }

    @Test
    void cleanAllSnapshot() {
        LocalConfigInfoProcessor.cleanAllSnapshot();
    }

    @Test
    void getFailoverFile() {
        assertThat(LocalConfigInfoProcessor.getFailoverFile("data.txt", "1234", "bar", "/bin/bash").getPath(), is("/home/thomas_perkins/nacos/config/data.txt_nacos/data/config-data-tenant/bin/bash/bar/1234"));
        assertThat(LocalConfigInfoProcessor.getFailoverFile("data.txt", "1234", "/bin/bash", "").getPath(), is("/home/thomas_perkins/nacos/config/data.txt_nacos/data/config-data/bin/bash/1234"));
    }

    @Test
    void getSnapshotFile() {
        assertThat(LocalConfigInfoProcessor.getSnapshotFile("data.txt", "1234", "bar", "/bin/bash").getPath(), is("/home/thomas_perkins/nacos/config/data.txt_nacos/snapshot-tenant/bin/bash/bar/1234"));
        assertThat(LocalConfigInfoProcessor.getSnapshotFile("data.txt", "1234", "/bin/bash", "").getPath(), is("/home/thomas_perkins/nacos/config/data.txt_nacos/snapshot/bin/bash/1234"));
    }
}
